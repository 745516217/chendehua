{include file=header.html}
<!--高级搜索-->
<div class="seek layout mt20">
	<div class="hd m_c_tit o_C1_40"><span class="one_tab">高级搜索</span></div>
	<form id="advanced_search" method="GET">
	<div class="options" id="">
		<div id="searchoptions">
		<input type="hidden" name="app" value="search">
		<div class="searchoptions_div">
			<div class="searchoptions_div_span1">分类</div>
			<ul id="searchoptions_ul_1">
				{$first_menu}
			</ul>
			<div style="clear:both"></div>
		</div>
		<div class="searchoptions_div" id="searchoptions_div_2">
			<div class="searchoptions_div_span1">尺寸</div>
			<ul id="searchoptions_ul_2">
				<li><label ><input type="radio" name="fmt[]" value="6寸方">六寸方版</label></li>
				<li><label ><input type="radio" name="fmt[]" value="8寸横">八寸横版</label></li>
				<li><label ><input type="radio" name="fmt[]" value="8寸竖">八寸竖版</label></li>
				<li><label ><input type="radio" name="fmt[]" value="10寸方">十寸方版</label></li>
				<li><label ><input type="radio" name="fmt[]" value="12寸竖">十二寸竖版</label></li>
				<li><label ><input type="radio" name="fmt[]" value="12寸横">十二寸横版</label></li>

			</ul>
		</div>
		<div style="clear:both"></div>
		<div class="searchoptions_div"  id="searchoptions_div_3">
			<div class="searchoptions_div_span1">装订</div>
			<ul id="searchoptions_ul_2">
				<li><label ><input type="checkbox" name="technology[]" value="高清相册">高清相册</label></li>
				<li><label ><input type="checkbox" name="technology[]" value="超高清相册">超高清相册</label></li>
				<li><label ><input type="checkbox" name="technology[]" value="超高清相册精装">超高清相册精装</label></li>

			</ul>
		</div>
		<div style="clear:both"></div>
		</div>
		<div style="height:8px;width:100%;margin-top:13px;"><!--空白--></div>
		<div class="searchoptions_div" id="searchoptions_div_4">
			<div class="searchoptions_div_span2">标签:</div>
			<ul id="searchoptions_ul_3" style="width:1130px;">
				<li class="searchtags"><span> 班书</span><em></em></li>
				<li class="searchtags"><span> 校园杂志</span><em></em></li>
				<li class="searchtags"><span> 小清新</span><em></em></li>
				<li class="searchtags"><span> 万圣节</span><em></em></li>
			</ul>
			<div style="clear:both"></div>

			<p class="btns_wrap tc" style="float:left;margin-left:480px;">
				<span class="search_btn"><a href="javascript:;" id="submit">搜索</a></span><a
					href="javascript:;" class="clear_btn" id="reset">清空搜索条件</a>
			</p>

		</div>
		<div style="clear:both"></div>
	</div>
	</form>
    <div id="result_zone" style="background-color:#fff;height:400px;" >
    </div>
</div>
<script>
    $("input[name='cate_id[]']").click(function()
    {
        $("#searchoptions_div_2").show(600);
    });
    $("input[name='fmt[]']").click(function()
    {
        $("#searchoptions_div_3").show(600);
    });

    $("#searchoptions_ul_3>li").click(function()
    {
        if ($(this).hasClass("searchtags"))
        {
            $(this).attr("class","issearchtags");
        }
        else
        {
            $(this).attr("class","searchtags");
        }
    });

	$(".search_btn").click(function() {
        var cate_id = $('input[name="cate_id[]"]:checked').val();
        var fmt = new Array();
	$("input[name='fmt[]']:checked").each(function(index,ele){
		fmt.push($(this).val());
	});
	var technology = new Array();
	var tags = new Array();
	$("input[name='technology[]']:checked").each(function(index,ele){
		technology.push($(this).val());
	});
	$(".issearchtags").each(function(index,ele){
		//tags.push(($(this).text()).trim());	//不支持IE8
		$.trim(tags.push($(this).text()));
	});
	var keyword = $("input[name='keyword']").val();

                $.ajax({
                    url: '{$site_url}/index.php?app=search&act=index',
                    type: 'GET',
                    data: {keyword:keyword,cate_id: cate_id, fmt: fmt, technology: technology, tags: tags},
                    beforeSend: function () {
                        $("#result_zone").html('loading');
                    },
                    success: function (data) {
                        $("#result_zone").html(data);
                    },
		    complete : function(xhr,st){
		    	$("#result_zone").css('height', '');
		    }
                });
		return false;
	}

	);
	$(function(){				//首先加载一次
		var keyword = $("input[name='keyword']").val();

		$.ajax({
                    url: '{$site_url}/index.php?app=search&act=index',
                    type: 'GET',
                    data: {keyword:keyword},
                    beforeSend: function () {
                        $("#result_zone").html('loading');
                    },
                    success: function (data) {
                        $("#result_zone").html(data);
                    },
                    complete : function(xhr,st){
                        $("#result_zone").css('height', '');
                    }
                });
		
	});

	$("#reset").click(function() {

		$("#advanced_search")[0].reset();
		$(".issearchtags").each(function(index,ele){
			$(this).attr("class","searchtags");
		});
		$("input[name='keyword']").val('');
		return false;
	});
	function ajaxPage(url)
	{
		$.ajax({
			url : url,
			beforeSend : function(){
				$("#result_zone").html('<div>loading...</div>');
			},
			success : function(data){
				$("#result_zone").html(data);
			}

		});
	}
</script>

{include file=footer.html}
